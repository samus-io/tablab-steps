# What is SQL injection (SQLi)?

* `SQL injection (SQLi)` is a web security flaw that allows malicious actors to disrupt and manipulate a query that an application makes to its database.
* The vulnerability arises when an attacker inserts SQL code via client-provided input data that is then included in a SQL query executed behind the scenes and processed as part of the query itself.

## How it works

* SQL injection techniques are possible because of the way certain web applications construct SQL statements, namely those in which SQL code previously written by programmers is mixed directly with user-supplied data, as the following example:

  ```sql
  SELECT name, email FROM users WHERE id=$id
  ```

  In the above statement, the variable `$id` contains the user identifier that has been provided as an input parameter, while the rest of the SQL query constants the static part defined by the programmer, thus making the SQL statement dynamic depending on the data provided in the web application.
* Due to the way the above SQL statement has been constructed, the user could send as an input parameter a value specially designed to make the original SQL statement execute arbitrary actions of the user's choice. For example, it would be possible to provide `117 or 1=1`, thus changing the logic of the SQL statement and modifying the `WHERE` clause, i.e., adding an always true condition such as `or 1=1`:
  ![Basic SQL Injection flow][1]
* As it can be seen, a successful SQL injection requires the adversary to produce a synthetically correct SQL query.
  * When the application returns an error message generated by an incorrect query, it is then easier to reconstruct the original query logic and therefore understand how to perform the insertion correctly.
  * If the application hides the details of an error, the adversary is forced to reverse engineer the original query logic in order to generate a valid statement.

## What could be achieved with SQLi

* Retrieve sensitive information from the database such as passwords, credit card details or personal user information.
* Modify database data (insert, update, or delete records).
* Access the content of specific files within the Database Management System (DBMS) file system.
* Execute administration operations on the database, such as shutting down the DBMS.
* Perform Denial-of-Service (DoS) attacks.
* Overcome a security mechanism, such as a login process, by altering the supposed value expected by the application in a given query for a specific set of data.
* In certain scenarios, an attacker can take advantage of a SQL injection to issue commands to the operating system, allowing the underlying server or other backend infrastructure to be compromised.
  * This represents a particularly risky situation, as it opens up the door for the attacker to establish a persistent backdoor into the organization's systems, leading to a long-term compromise that can remain undetected for an extended duration.
* As a collateral effect, cause reputational damage and regulatory fines if data is extracted and published or sold.

## Threat modeling

* SQL Injection has become a prevalent concern with database-driven websites. This vulnerability is relatively easy to identify and exploit, making it a common target. Therefore, any website or software application that manages a database is likely to face attempted attacks of this nature.
* This security flaw is frequently encountered in PHP and ASP applications, primarily because older functional interfaces are commonly used. In contrast, Java and ASP.NET applications are generally less susceptible to easily exploitable SQL injections due to the inherent characteristics of their programmatic interfaces.

[1]: /static/images/learning/basic-sql-injection-exploitation-flow.png
