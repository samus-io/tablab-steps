# Information disclosure via backup files

* Backup files containing sensitive data may lead to information disclosure if they are unintentionally exposed on web applications without sufficient access restrictions. When exposed, these files may hold sensitive information such as database credentials, configuration details, or source code, making them a prime target for attackers.
* These files may be automatically generated by backup systems or manually created by developers and administrators, often in urgent situations requiring a hotfix to address a system failure or security vulnerability.
  * Furthermore, storing them in predictable locations like `/backup` directories raises the risk of unauthorized access.
* File extensions like `.bak`, `.zip`, `.tar`, and `.old` are frequently used for backups, which malicious users might specifically search for.

## Potential threats caused by information disclosure through backup files

* Backup archives often store configuration details, database records, or authentication keys, which can be exploited to further compromise systems. If an attacker accesses a backup file, they can examine its contents, including source code or credentials, to detect and exploit additional vulnerabilities.
* Unintentional exposure of backup files can create other significant security risks, including the compromise of sensitive data confidentiality and breaches of privacy. In some cases, unauthorized access to backup archives may lead to non-compliance with data protection regulations, subjecting organizations to legal and financial repercussions.

## Methods for identifying exposed backup files

* When the presence of backup files on an instance is unclear, specific commands can help in locating them:
  * In Linux, the `find` command can be used to search within the root of the web directory:

    ```bash
    find . -type f -regex ".*\.\(bak\|txt\|src\|dev\|old\|inc\|orig\|copy\|tmp\)$"
    ```

  * In Windows, the `cmd.exe` command can scan for common backup file extensions:

    ```cmd
    dir *.bak *.txt *.src *.dev *.old *.inc *.orig *.copy *.tmp /s /b
    ```

  * Additionally, `PowerShell` provides an alternative method for identifying backup files across directories:

    ```powershell
    Get-ChildItem -Recurse -File | Where-Object { $_.Name -match "\.(bak|txt|src|dev|old|inc|orig|copy|tmp)$" }
    ```

* Publicly accessible backup files may also be indexed by search engines, making them easy targets for malicious users. Google Dorking, a technique that leverages advanced search operators to find publicly accessible information, can be used to identify exposed backup files:
  * Searching for common backup file extensions within a specific domain:

    ```plaintext
    site:example.tbl filetype:bak OR filetype:zip OR filetype:tar OR filetype:old
    ```

  * Identifying publicly accessible backup directories within a specific domain:

    ```plaintext
    site:example.tbl inurl:/backup/ OR intitle:"index of /backup"
    ```

* Regular scans for these files assist in detecting exposed backups and applying appropriate security actions.

### Discovering hidden files of any type through brute-force offensive techniques

* Malicious users frequently employ brute-force methods to guess file names and paths by sending numerous requests with a customized wordlist.
* The command-line tool named `wfuzz` is commonly used to brute-force directories and files in web applications, helping uncover hidden or unlinked resources.
* As a demonstrative example, the command below uses `wfuzz` to attempt discovery of hidden files or directories under the specified path `/` by replacing `FUZZ` with entries from the wordlist `common.txt`, while ignoring `404 Not Found` responses:

  ```bash
  wfuzz -c -w common.txt --hc 404 <url>/FUZZ
  ```

  * `-c`: shows the output with colors.
  * `-w`: specifies the wordlist (`common.txt`) containing potential file or directory names to try.
  * `--hc 404`: hides responses that return a `404 Not Found` HTTP status code, focusing only on potentially valid paths.
  * `<url>/FUZZ`: represents the targeted URL where `FUZZ` is a placeholder that `wfuzz` will replace with each entry from the wordlist.

#### Common paths that may hold backup files

  |Directory|Description|
  |:--:|:--|
  |`/backup/`|Generic backup folder used in many setups.|
  |`/backups/`|Plural form often used for multiple backups.|
  |`/bak/`|Abbreviation for "backup".|
  |`/old/`|Often used to store previous versions.|
  |`/archive/`|Used for archived data, including old backups.|
  |`/_backup/`|Hidden-style naming with underscore prefix.|
  |`/site_old/`|Indicates an older version of the site.|
  |`/www-old/`|Legacy naming convention for older site data.|
  |`/dev/`|Might contain developer versions or copies.|
  |`/tmp/`|Temporary storage—can include dumped backups.|
  |`/test/`|Used during testing—sometimes stores full backups.|
  |`/uploads/`|May contain database or config dumps uploaded for testing.|

## Recommended security approaches

* **Storing backups on dedicated backup services or isolated infrastructure** minimizes accidental exposure by ensuring they're kept away from exposed environments.
* **Strict access permission management** reduces exposure risks, specifically by adhering to the principle of least privilege, allowing only authorized users to access backup files.
* **Protecting backups with encryption** guarantees that even if unauthorized access occurs, the data remains protected and unreadable.

## Exercise to practice :writing_hand:

* The following web application contains an unlinked and exposed backup file that it is publicy accessible. The objective is to find it using the `wfuzz` tool by brute-forcing the application.
  * There is an environment variable named `$APP_URL` that contains the base URL of the application to facilitate request sending.
  * A wordlist located in the `tbl` user's home directory can also be used with the `wfuzz` tool.
  * A helpful clue is to investigate typical directories where backup files might be stored.
* Once the backup file has been found, no further action is required to complete the exercise.

  @@ExerciseBox@@
