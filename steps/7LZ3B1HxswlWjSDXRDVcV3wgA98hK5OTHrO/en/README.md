# Information disclosure via backup files

* Backup files containing sensitive data may lead to information disclosure if they are unintentionally exposed on web applications without sufficient access restrictions. When exposed, these files may hold sensitive information such as database credentials, configuration details, or source code, making them a prime target for attackers.
* These files may be automatically generated by backup systems or manually created by developers and administrators, often in urgent situations requiring a hotfix to address a security vulnerability or system failure.
  * Furthermore, storing them in predictable locations like `/backup` directories raises the risk of unauthorized access.
* File extensions like `.bak`, `.zip`, `.tar`, and `.old` are frequently used for backups, which malicious users might specifically search for.

## Potential threats caused by information disclosure through backup archives

* Unintentional exposure of backup files can create significant security risks, including the compromise of sensitive data confidentiality and breaches of privacy. In some cases, unauthorized access to backup archives may lead to non-compliance with data protection regulations, subjecting organizations to legal and financial repercussions.
* Backup archives often store configuration details, database records, or authentication keys, which can be exploited to further compromise systems. If an attacker accesses a backup file, they can examine its contents, including source code or credentials, to detect and exploit additional vulnerabilities.

## Methods for identifying exposed backup files

* When the presence of backup files on the server is unclear, specific commands can help in locating them:
  * In Linux, the `find` command can be used to search within the root of the web directory:

    ```bash
    find . -type f -regex ".*\.\(bak\|txt\|src\|dev\|old\|inc\|orig\|copy\|tmp\)$"
    ```

  * In Windows, the `cmd.exe` command can scan for common backup file extensions:

    ```cmd
    dir *.bak *.txt *.src *.dev *.old *.inc *.orig *.copy *.tmp /s /b
    ```

  * Additionally, `PowerShell` provides an alternative method for identifying backup files across directories:

    ```powershell
    Get-ChildItem -Recurse -File | Where-Object { $_.Name -match "\.(bak|txt|src|dev|old|inc|orig|copy|tmp)$" }
    ```

* Publicly accessible backup files may be indexed by search engines, making them easy targets for malicious users. Google Dorking, a technique using advanced search operators to find publicly accessible information, can be used to identify exposed backup files:
  * Searching for common backup file extensions within a specific domain:

    ```plaintext
    site:example.tbl filetype:bak OR filetype:zip OR filetype:tar OR filetype:old
    ```

  * Identifying publicly accessible backup directories within a specific domain:

    ```plaintext
    site:example.tbl inurl:/backup/ OR intitle:"index of /backup"
    ```

* Regular scans for these files assist in detecting exposed backups and applying appropriate security actions.

## Recommended security approaches

* **Storing backups on dedicated servers** helps prevent accidental exposure by keeping them on internal systems that are not accessible from the internet.
* **Strict access permission management** reduces exposure risks, specifically by adhering to the principle of least privilege, allowing only authorized users to access backup files.
* **Protecting backups with encryption** guarantees that even if unauthorized access occurs, the data remains protected and unreadable.
