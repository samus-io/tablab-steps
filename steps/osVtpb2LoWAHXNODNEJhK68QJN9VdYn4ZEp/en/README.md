# Same-Origin Policy basics

* The `Same-Origin Policy (SOP)` is an important concept for the security of web pages. It is not an Internet standard, but a security policy of web browsers. This policy prevents interaction between pages of different origins.
* An origin is defined by the combination of protocol, host and port:

  ```powershell
  https://domain.tbl
  http://example.tbl:8080
  ```

* In the first example we have the protocol `https`, the host `domain.tbl` and the port `443`.
* In the second example the protocol is `http`, host `example.tbl` and port `8080`.

## How SOP works

* The `SOP` policy can be summarized as follows: *"You can access the properties of another document only if you have the same origin "*. It basically prevents JavaScript code from one origin from accessing content generated by another origin.
* Not all content is considered a *"document "*, there are some exceptions. CSS files, JavaScript and images are excluded from the `SOP` policy. Allowing an origin to make requests and interact with the response of these. If this were not the case, it would not be possible to display images or include JavaScript code from other origins.
* An example where the `SOP` policy is applied could be the following:
  ![SOP Example][1]
  * The user makes a request to `https://domain.tbl` and upon loading the JavaScript code, it makes a request to `https://example.tbl/account`.
  * The request is successful but when the JavaScript code will try to read the response, the `SOP` will block that action.
  * In this way, the origin `https://domain.tbl` is prevented from accessing information from the origin `https://example.tbl`. If this were not the case, the response could collect sensitive user data.

## When the SOP policy is applied

* The browser applies the `SOP` policy in cases where it considers that there is a potential interaction between two different origins. These interactions can be summarized as follows:
  * JavaScript code: A page cannot access the content of an `iframe` unless it is from the same origin.
  * Cookies: A cookie cannot be shared with different origins.
    * Cookies work differently, only the host is considered the origin, so that only the domain and subdomain form the origin.
  * AJAX requests (`XmlHTTPRequest`): JavaScript requests interacting with another origin will be successful, but the response from a different origin will not be accessible.
* The `SOP` policy does not completely eliminate interaction between two different origins. There are some cases in which this interaction is allowed, such as the following:
  * As mentioned above, requests can be made between different origins, so that there is interaction between them, but the response cannot be accessed. This also applies to forms, so you can create a form and send it to another origin.
  * Another case is when we use an `iframe`, where it allows us to load the content of a different origin through a `frame` (as long as other security policies allow us to do so). It should be noted that although it is possible to create a `frame` from another origin, the rule remains the same, you can not access the response or content of the `frame` but it is possible to interact with it.
    * Also CSS, JavaScript and images are excluded from the `SOP` policy.

[1]: /static/images/learning/how-sop-works-example.png
