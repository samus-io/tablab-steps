# Information disclosure via error messages

* Information disclosure via error messages occurs when applications expose sensitive information to users through error messages.
* This typically happens due to improper handling of errors and exceptions in the code, which can unintentionally reveal the stack trace of the error, framework information, system details, user data, or other sensitive information.
* Such disclosures can provide attackers with insights to understand the system's architecture and identify potential weaknesses to exploit.

## How this type of information disclosure arise?

* When applications send **detailed user error messages**, such as `User does not exist` or `Correct username, incorrect password`, these can help an attacker determine valid user accounts or other system details.
* **Displaying error messages** with stack traces, database dumps, or code snippets can inadvertently reveal underlying software architecture, database schemas, or configuration details.
* Error messages containing SQL errors, unhandled exceptions, or file paths can leak internal details. Some examples of messages that should not be sent to the user can be:

  ```sql
  SQL syntax error near 'user_input' in query SELECT * FROM users WHERE username = 'user_input'.
  ```

  ```java
  NullReferenceException: Object reference not set to an instance of an object at Project.Service.Authentication.CheckUser(String username, String password).
  ```

  ```java
  File not found at "C:\Program Files\MyApp\config.xml".
  ```

* **Insufficient input validation** can lead to errors when unexpected values or types are entered by a user, potentially generating error messages that reveal system internals or logic. Examples of error messages that should not be displayed to users include:

  ```
  The input 'abc123' is invalid for field 'age', expected type integer.
  ```

  ```
  XML parser error: element 'login' is not recognized.
  ```

## Best practices to prevent information disclosure

* **Implement generic error messages** for end users, rather than sending the default error to the user (.e.g `Internal Server Error`, `An error ocurred, refresh the page`, etc).
* Develop a **custom error handling** mechanism that catches and logs all exceptions and errors thrown, without exposing sensitive information to the end user.
* Implement robust **input validation** to prevent errors that could potentially disclose system information through messages generated by exceptions.
